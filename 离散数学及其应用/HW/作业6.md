# Section 4.1

### 17

a) 10 

b) 8 

c) 0 

d) 9 

e) 6 

f) 11

### 38

a) $(19^2 \mod 41) \mod 9 = (361 \mod 41) \mod 9 = 33 \mod 9 = 6$ 

b) $(32^3 \mod 13)^2 \mod 11 = (32768 \mod 13)^2 \mod 11 = 8^2 \mod 11 = 64 \mod 11 = 9$ 

c) $(7^3 \mod 23)^2 \mod 31 = (343 \mod 23)^2 \mod 31 = 21^2 \mod 31 = 441 \mod 31 = 7$ 

d) $(21^2 \mod 15)^3 \mod 22 = (441 \mod 15)^3 \mod 22 = 6^3 \mod 22 = 216 \mod 22 =18$

### 49

为了证明封闭性，注意到$a \cdot_m b = (a \cdot b) \mod m$，根据定义是$Z_m$的元素。乘法是可结合的，因为$(a \cdot_m b) \cdot_m c$和$a \cdot_m (b \cdot_m c)$都等于$(a \cdot b \cdot c) \mod m$，而整数的乘法是可结合的。同样，$Z_m$中的乘法是可交换的，因为整数中的乘法是可交换的，而1是$Z_m$的乘法恒等元，因为1是Z的乘法恒等元。

# Section 4.2

### 26

这个算法实际上计算了$11 \mod 645$，$11^2 \mod 645$，$11^4 \mod 645$，$11^8 \mod 645$，$11^{16} \mod 645$，…，然后将所需的值相乘（模645）。由于$644 = (1010000100)_2$，我们需要将$11^4 \mod 645$，$11^{128} \mod 645$和$11^{512} \mod 645$相乘，每一步都要模645

通过重复平方来计算：$11^2 \mod 645 = 121$， $11^4 \mod 645 = 121^2 \mod 645 = 14641 \mod 645 = 451$， $11^8 \mod 645 = 451^2 \mod 645 = 203401 \mod 645 = 226$， $11^{16} \mod 645 = 226^2 \mod 645 = 51076 \mod 645 = 121$。此时我们注意到121在我们的计算中出现过，所以我们有 $11^{32} \mod 645 =121^2\ mod\ 645=451$, $11{64} mod 645=4512\ mod\ 645=226$, $11{128} mod 645=2262\ mod\ 645=121$, $11^{256}\ mod\ 645=451$, $11^{512}\ mod\ 645=226$.因此我们最终的答案将是451、121和226的乘积，模645。我们一次计算这些： $451\times121\ mod\ 645=54571\ mod\ 645=391$, 并且 $391\times226\ mod\ 645=88366\ mod\ 645=1$. 

### 55

```pseudocode
procedure Cantor(x: positive integer)
	n := 1; f := 1
	while (n + 1) ⋅ f ≤ x
		n := n + 1
		f := f ⋅ n
		y := x
	while n > 0
		an := ⌊y∕f⌋
		y := y − an ⋅ f
		f := f ∕n
		n := n − 1
{x = ann! + an−1(n − 1)! +⋯+ a11!}
```

### 64

将两个最多为$logm$位的整数相乘，再除以$m$，这就是模$m$乘法，这需要$(logm)^2$位操作。这就是Algorithm 5循环内部发生的事情。循环迭代$logn$次。因此，总位操作数为$O((logm)^2logn)$。

# Section 4.3

### 13

3,5,7

### 21

a) 2 

b) 4 

c) 12

### 57

给定一个正整数$x$，我们证明存在唯一的一个正有理数$m/n$（以最简形式），使得$K(m/n) = x$。从$x$的质因数分解中，读出$m$和$n$，使得$K(m/n) = x$。出现在偶数次幂中的质数是出现在$m$的质因数分解中的质数，指数是$x$中相应指数的一半；出现在奇数次幂中的质数是出现在$n$的质因数分解中的质数，指数是$x$中指数加一后再除以二。

# Section 4.4

### 9

4在模9下的逆元为8。因此，我们可以将同余式4x ≡ 5 (mod 9)两边同时乘以8，得到x ≡ 40 ≡ 4 (mod 9)。所以x在模9下的一个解为4

### 21

$323 + 330k$    $k \in \Z$

根据中国剩余定理，我们可以用以下方法求解同余方程组 $x ≡ 1 \pmod{2}$，$x ≡ 2 \pmod{3}$，$x ≡ 3 \pmod{5}$ 和 $x ≡ 4 \pmod{11}$

首先，我们计算 $M = 2 \times 3 \times 5 \times 11 = 330$。然后，我们计算 $M_1 = M/2 = 165$，$M_2 = M/3 = 110$，$M_3 = M/5 = 66$ 和 $M_4 = M/11 = 30$

接下来，我们需要找到每个 $M_i$ 的逆元。即找到整数 $y_i$，使得 $M_i y_i ≡ 1 \pmod{m_i}$。我们可以通过扩展欧几里得算法来求解。对于这个例子，我们可以找到 $y_1 = 1$，$y_2 = 2$，$y_3 = 1$ 和 $y_4 = 3$

最后，我们可以计算出同余方程组的一个特殊解：$x_0 = a_1 M_1 y_1 + a_2 M_2 y_2 + a_3 M_3 y_3 + a_4 M_4 y_4 = 1 \times 165 \times 1 + 2 \times 110 \times 2 + 3 \times 66 \times 1 + 4 \times 30 \times 3 = 323$。

因此，同余方程组的所有解为 $x = x_0 + kM = 323 + 330k$, 其中 $k \in \Z$

### 27

$323 + 252k$    $k \in \Z$



根据中国剩余定理，我们可以用以下方法求解同余方程组 $x ≡ 7 \pmod{9}$，$x ≡ 4 \pmod{12}$ 和 $x ≡ 16 \pmod{21}$

首先，我们计算 $M = 9 \times 12 \times 21 = 2268$。然后，我们计算 $M_1 = M/9 = 252$，$M_2 = M/12 = 189$ 和 $M_3 = M/21 = 108$

接下来，我们需要找到每个 $M_i$ 的逆元。即找到整数 $y_i$，使得 $M_i y_i ≡ 1 \pmod{m_i}$。我们可以通过扩展欧几里得算法来求解。对于这个例子，我们可以找到 $y_1 = 4$，$y_2 = 4$ 和 $y_3 = 1$

最后，我们可以计算出同余方程组的一个特殊解：$x_0 = a_1 M_1 y_1 + a_2 M_2 y_2 + a_3 M_3 y_3 = 7 \times 252 \times 4 + 4 \times 189 \times 4 + 16 \times 108 \times 1 = 323$

因此，同余方程组的所有解为 $x = x_0 + kM = 323 + 2268k$, 其中 $k \in \Z$

### 33

7

费马小定理指出，如果 $p$ 是一个质数且 $a$ 是一个整数，那么 $a^{p-1} \equiv 1 \pmod{p}$。在这个例子中，$p = 13$，所以我们有 $7^{12} \equiv 1 \pmod{13}$。

因此，我们可以将指数 $121$ 分解为 $12 \times 10 + 1$。那么，$7^{121} = 7^{12 \times 10 + 1} = (7{12}){10} \times 7^1 \equiv 1^{10} \times 7^1 \equiv 7 \pmod{13}$。

所以，$7^{121} \pmod{13}$ 的答案是 $7$
